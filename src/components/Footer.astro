---
import { getPosts } from '../data/wp.ts';
import { about, connect } from '../data/site.ts';
import { decodeEntities } from '../lib/text.ts';
import IconGithub from '../assets/images/icon-github.svg?url';
import IconGitlab from '../assets/images/icon-gitlab.svg?url';
import IconLinkedin from '../assets/images/icon-linkedin.svg?url';
import IconEnvelope from '../assets/images/icon-envelope.svg?url';

// Fetch the latest 4 posts at build time
const { items: latestPosts } = await getPosts({ perPage: 4, page: 1 });
---

<!-- Footer top section -->
<div class="footer-top">
  <div class="container">
    <div class="footer-grid">
      <!-- Latest Articles -->
      <div class="footer-section footer-articles">
        <h3 class="mb-2 pb-1">Latest Articles</h3>
        <ul class="footer__links">
          {latestPosts.slice(0, 4).map(post => (
            <li class="my-1">
              <a href={`/posts/${post.slug}`}>
                {decodeEntities(post.title.rendered)}
              </a>
            </li>
          ))}
        </ul>
      </div>
      
      <!-- About me -->
      <div class="footer-section footer-about">
        <h3 class="mb-2 pb-1">{about.title}</h3>
        <p class="footer__about">
          {about.blurb}
        </p>
        {about.cta && (
          <a href={about.cta.href} class="footer__cta">
            {about.cta.label}
          </a>
        )}
      </div>
      
      <!-- Connect -->
      <div class="footer-section footer-connect">
        <h3 class="mb-2 pb-1">Connect</h3>
        <div class="connect-icons">
          <a href={connect.github} aria-label="GitHub" rel="noopener noreferrer" target="_blank">
            <img src={IconGithub} alt="" class="connect-icon" />
          </a>
          <a href={connect.gitlab} aria-label="GitLab" rel="noopener noreferrer" target="_blank">
            <img src={IconGitlab} alt="" class="connect-icon" />
          </a>
          <a href={connect.linkedin} aria-label="LinkedIn" rel="noopener noreferrer" target="_blank">
            <img src={IconLinkedin} alt="" class="connect-icon" />
          </a>
          <a href={connect.email} aria-label="Email">
            <img src={IconEnvelope} alt="" class="connect-icon" />
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Footer bottom section -->
<div class="footer-bottom">
  <div class="container">
    <p>
      Â© 1999-2025 Argensonix Multimedia<br />
      Made in Buenos Aires
    </p>
  </div>
</div>
